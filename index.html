<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BetterMe.ai: สมองส่วนที่สองด้านสุขภาพ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f8fafc; color: #334155; }
        .active-tab { background-color: #0d9488; color: white; border-color: #0d9488; }
        .inactive-tab { background-color: white; color: #64748b; border-color: #e2e8f0; }
        .scenario-card { transition: all 0.2s ease-in-out; cursor: pointer; }
        .scenario-card:hover { transform: translateY(-2px); border-color: #0d9488; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .scenario-card.active { border-color: #0d9488; background-color: #f0fdfa; ring: 2px solid #0d9488; }
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen">

    <div class="max-w-7xl mx-auto space-y-6">
        <!-- Header -->
        <header class="text-center space-y-2">
            <div class="inline-flex items-center gap-2 bg-teal-50 px-4 py-1 rounded-full text-teal-700 text-sm font-bold border border-teal-100 mb-2">
                <i class="fa-solid fa-brain"></i> BetterMe.ai
            </div>
            <h1 class="text-3xl md:text-4xl font-bold text-slate-800">สมองส่วนที่สองด้านสุขภาพ</h1>
            <p class="text-slate-500 max-w-2xl mx-auto">ระบบเชื่อมโยง "สิ่งที่กิน" + "สิ่งที่ใช้" + "สภาพจิตใจ" เพื่อสร้างสมดุลชีวิตที่ยั่งยืน</p>
        </header>

        <!-- Function Selector (Tabs) -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
            <button onclick="switchTab(1)" id="tab-1" class="active-tab p-3 rounded-xl border shadow-sm font-bold text-sm md:text-base flex flex-col md:flex-row items-center justify-center gap-2 transition-all">
                <i class="fa-solid fa-trophy"></i> <span>1. ปรับพฤติกรรม & Rewards</span>
            </button>
            <button onclick="switchTab(2)" id="tab-2" class="inactive-tab p-3 rounded-xl border shadow-sm font-bold text-sm md:text-base flex flex-col md:flex-row items-center justify-center gap-2 transition-all">
                <i class="fa-solid fa-heart-pulse"></i> <span>2. จัดการ NCDs เชิงลึก</span>
            </button>
            <button onclick="switchTab(3)" id="tab-3" class="inactive-tab p-3 rounded-xl border shadow-sm font-bold text-sm md:text-base flex flex-col md:flex-row items-center justify-center gap-2 transition-all">
                <i class="fa-solid fa-spa"></i> <span>3. วิเคราะห์ กาย-จิต</span>
            </button>
            <button onclick="switchTab(4)" id="tab-4" class="inactive-tab p-3 rounded-xl border shadow-sm font-bold text-sm md:text-base flex flex-col md:flex-row items-center justify-center gap-2 transition-all">
                <i class="fa-solid fa-utensils"></i> <span>4. สั่งอาหารตามสั่ง</span>
            </button>
        </div>

        <!-- Content Display Area -->
        <div class="bg-white rounded-3xl shadow-xl border border-slate-200 overflow-hidden min-h-[650px] relative">
            
            <!-- FUNCTION 1: Adaptive Checklist & Rewards -->
            <div id="view-1" class="p-6 md:p-8 fade-in h-full">
                <div class="flex flex-col lg:flex-row gap-8 h-full">
                    <!-- Left: Situation Simulator -->
                    <div class="lg:w-1/3 space-y-4 border-r border-slate-100 pr-0 lg:pr-6 h-[600px] overflow-y-auto custom-scroll">
                        <div class="space-y-1 sticky top-0 bg-white pb-2 z-10">
                            <h3 class="text-xl font-bold text-teal-700">เลือกสถานการณ์ (Input)</h3>
                            <p class="text-sm text-slate-500">จำลองปัญหาเพื่อรับ Mission และ Points</p>
                        </div>
                        
                        <div class="space-y-3">
                            <!-- Scenario 1: Sugar -->
                            <div onclick="runBehavior('sugar')" class="scenario-card p-4 rounded-xl border border-slate-200 bg-white group">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-full bg-pink-100 text-pink-600 flex items-center justify-center text-xl"><i class="fa-solid fa-glass-water"></i></div>
                                    <div>
                                        <div class="font-bold text-slate-700">1. ติดหวาน/น้ำชง</div>
                                        <div class="text-xs text-slate-500">Sugar Reduction Mission</div>
                                    </div>
                                </div>
                            </div>
                            <!-- Scenario 2: Sedentary -->
                            <div onclick="runBehavior('sedentary')" class="scenario-card p-4 rounded-xl border border-slate-200 bg-white group">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-xl"><i class="fa-solid fa-chair"></i></div>
                                    <div>
                                        <div class="font-bold text-slate-700">2. ออฟฟิศซินโดรม</div>
                                        <div class="text-xs text-slate-500">Anti-Sedentary Mission</div>
                                    </div>
                                </div>
                            </div>
                            <!-- Scenario 3: Mindful Eating -->
                            <div onclick="runBehavior('mindful')" class="scenario-card p-4 rounded-xl border border-slate-200 bg-white group">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-full bg-orange-100 text-orange-600 flex items-center justify-center text-xl"><i class="fa-solid fa-stopwatch"></i></div>
                                    <div>
                                        <div class="font-bold text-slate-700">3. กินเร็ว/กินดึก</div>
                                        <div class="text-xs text-slate-500">Mindful Eating Mission</div>
                                    </div>
                                </div>
                            </div>
                            <!-- Scenario 4: Neat Activity -->
                            <div onclick="runBehavior('neat')" class="scenario-card p-4 rounded-xl border border-slate-200 bg-white group">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-full bg-green-100 text-green-600 flex items-center justify-center text-xl"><i class="fa-solid fa-person-walking"></i></div>
                                    <div>
                                        <div class="font-bold text-slate-700">4. ขี้เกียจออกกำลัง</div>
                                        <div class="text-xs text-slate-500">Neat Activity Mission</div>
                                    </div>
                                </div>
                            </div>
                            <!-- Scenario 5: Sleep -->
                            <div onclick="runBehavior('sleep')" class="scenario-card p-4 rounded-xl border border-slate-200 bg-white group">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-xl"><i class="fa-solid fa-moon"></i></div>
                                    <div>
                                        <div class="font-bold text-slate-700">5. ติดจอ/นอนดึก</div>
                                        <div class="text-xs text-slate-500">Sleep Hygiene Mission</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right: Rewards & AI Output -->
                    <div class="lg:w-2/3 space-y-4 h-full flex flex-col">
                        
                        <!-- Social & Rewards Dashboard (Always Visible) -->
                        <div class="bg-gradient-to-r from-teal-500 to-emerald-600 rounded-2xl p-4 text-white shadow-lg shrink-0">
                            <div class="flex justify-between items-center mb-3">
                                <div>
                                    <h3 class="font-bold text-lg"><i class="fa-solid fa-medal"></i> Your Success Rate</h3>
                                    <p class="text-teal-100 text-xs">ทำ Mission สำเร็จต่อเนื่อง 5 วัน</p>
                                </div>
                                <div class="text-right">
                                    <div class="text-2xl font-bold">85%</div>
                                    <div class="text-xs bg-white/20 px-2 py-0.5 rounded-full">Level: Resilience</div>
                                </div>
                            </div>
                            <!-- Progress Bar -->
                            <div class="w-full bg-teal-800/30 rounded-full h-2 mb-4">
                                <div class="bg-white h-2 rounded-full" style="width: 85%"></div>
                            </div>
                            
                            <!-- Redeemable Rewards -->
                            <div class="flex gap-3 overflow-x-auto pb-1 custom-scroll">
                                <div class="bg-white/10 backdrop-blur p-2 rounded-lg border border-white/20 min-w-[120px] text-center cursor-pointer hover:bg-white/20 transition">
                                    <i class="fa-solid fa-shield-heart text-xl mb-1"></i>
                                    <div class="text-xs font-bold">ส่วนลดประกัน</div>
                                    <div class="text-[10px] text-teal-100">ใช้ 500 แต้ม</div>
                                </div>
                                <div class="bg-white/10 backdrop-blur p-2 rounded-lg border border-white/20 min-w-[120px] text-center cursor-pointer hover:bg-white/20 transition">
                                    <i class="fa-solid fa-leaf text-xl mb-1"></i>
                                    <div class="text-xs font-bold">ส่วนลดสลัด</div>
                                    <div class="text-[10px] text-teal-100">ใช้ 200 แต้ม</div>
                                </div>
                                <div class="bg-white/10 backdrop-blur p-2 rounded-lg border border-white/20 min-w-[120px] text-center cursor-pointer hover:bg-white/20 transition">
                                    <i class="fa-solid fa-dumbbell text-xl mb-1"></i>
                                    <div class="text-xs font-bold">คลาสโยคะฟรี</div>
                                    <div class="text-[10px] text-teal-100">ใช้ 800 แต้ม</div>
                                </div>
                            </div>
                        </div>

                        <!-- AI Response Area -->
                        <div class="bg-slate-50 rounded-2xl p-6 border border-slate-200 flex-1 relative overflow-hidden">
                            <div class="absolute top-4 right-4 bg-white px-3 py-1 rounded-full shadow-sm text-xs font-bold text-slate-400 border border-slate-200 z-10">
                                AI ADAPTIVE PLAN
                            </div>
                            
                            <div id="f1-content" class="h-full flex flex-col justify-center items-center text-slate-400 text-center overflow-y-auto custom-scroll">
                                <i class="fa-solid fa-hand-pointer text-4xl mb-2 animate-bounce"></i>
                                <p>เลือกปัญหาสุขภาพด้านซ้าย<br>เพื่อรับ Mission ปรับพฤติกรรม</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FUNCTION 2: NCDs Precision Management -->
            <div id="view-2" class="hidden p-6 md:p-8 fade-in h-full">
                <div class="flex flex-col lg:flex-row gap-8 h-full">
                    <!-- Left: Disease Selector -->
                    <div class="lg:w-1/3 space-y-4 border-r border-slate-100 pr-0 lg:pr-6 h-[600px] overflow-y-auto custom-scroll">
                        <div class="space-y-1 sticky top-0 bg-white pb-2 z-10">
                            <h3 class="text-xl font-bold text-blue-700">เลือกกรณีศึกษา (Case Study)</h3>
                            <p class="text-sm text-slate-500">แผนจัดการโรคและคำแนะนำเฉพาะบุคคล</p>
                        </div>

                        <div class="space-y-3">
                            <button onclick="showNCDCase('diabetes')" class="w-full p-4 rounded-xl border border-blue-200 bg-blue-50 hover:bg-blue-100 text-left transition-all">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-full bg-white text-blue-600 flex items-center justify-center font-bold border border-blue-100 shrink-0">DM</div>
                                    <div>
                                        <div class="font-bold text-blue-900">โรคเบาหวาน (Type 2)</div>
                                        <div class="text-xs text-blue-600">Focus: Glucose Control</div>
                                    </div>
                                </div>
                            </button>
                            <button onclick="showNCDCase('hypertension')" class="w-full p-4 rounded-xl border border-red-200 bg-red-50 hover:bg-red-100 text-left transition-all">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-full bg-white text-red-600 flex items-center justify-center font-bold border border-red-100 shrink-0">HT</div>
                                    <div>
                                        <div class="font-bold text-red-900">โรคความดันโลหิตสูง</div>
                                        <div class="text-xs text-red-600">Focus: Sodium & Stress</div>
                                    </div>
                                </div>
                            </button>
                            <button onclick="showNCDCase('dyslipidemia')" class="w-full p-4 rounded-xl border border-yellow-200 bg-yellow-50 hover:bg-yellow-100 text-left transition-all">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-full bg-white text-yellow-600 flex items-center justify-center font-bold border border-yellow-100 shrink-0">DLP</div>
                                    <div>
                                        <div class="font-bold text-yellow-900">ไขมันในเลือดสูง</div>
                                        <div class="text-xs text-yellow-600">Focus: Oil Type & Sugar</div>
                                    </div>
                                </div>
                            </button>
                            <button onclick="showNCDCase('copd')" class="w-full p-4 rounded-xl border border-gray-200 bg-gray-50 hover:bg-gray-100 text-left transition-all">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-full bg-white text-gray-600 flex items-center justify-center font-bold border border-gray-100 shrink-0">COPD</div>
                                    <div>
                                        <div class="font-bold text-gray-900">ปอดอุดกั้นเรื้อรัง</div>
                                        <div class="text-xs text-gray-600">Focus: Breathing & Energy</div>
                                    </div>
                                </div>
                            </button>
                            <button onclick="showNCDCase('cancer')" class="w-full p-4 rounded-xl border border-purple-200 bg-purple-50 hover:bg-purple-100 text-left transition-all">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-full bg-white text-purple-600 flex items-center justify-center font-bold border border-purple-100 shrink-0">CA</div>
                                    <div>
                                        <div class="font-bold text-purple-900">โรคมะเร็ง</div>
                                        <div class="text-xs text-purple-600">Focus: Hygiene & Nutrition</div>
                                    </div>
                                </div>
                            </button>
                            <button onclick="showNCDCase('metabolic')" class="w-full p-4 rounded-xl border border-orange-200 bg-orange-50 hover:bg-orange-100 text-left transition-all">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-full bg-white text-orange-600 flex items-center justify-center font-bold border border-orange-100 shrink-0">MetS</div>
                                    <div>
                                        <div class="font-bold text-orange-900">โรคอ้วนลงพุง</div>
                                        <div class="text-xs text-orange-600">Focus: Metabolism</div>
                                    </div>
                                </div>
                            </button>
                        </div>
                    </div>

                    <!-- Right: AI Analysis Display -->
                    <div class="lg:w-2/3 space-y-6">
                        <div id="ncd-content" class="bg-white rounded-xl border border-slate-200 p-6 shadow-sm min-h-[400px] h-full flex flex-col justify-center items-center">
                            <div class="text-center text-slate-400">
                                <i class="fa-solid fa-user-doctor text-4xl mb-4"></i>
                                <p>เลือกกรณีศึกษาโรคทางด้านซ้าย<br>เพื่อดูการวิเคราะห์และ Do & Don't</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FUNCTION 3: Holistic Mental & Physical Correlation (Same as before) -->
            <div id="view-3" class="hidden p-6 md:p-8 fade-in h-full">
                <div class="flex flex-col lg:flex-row gap-8 h-full">
                    <!-- Left: 5 Problems Input -->
                    <div class="lg:w-1/3 space-y-4 border-r border-slate-100 pr-0 lg:pr-6 overflow-y-auto custom-scroll max-h-[600px]">
                        <div class="space-y-2 sticky top-0 bg-white z-10 pb-2">
                            <h3 class="text-xl font-bold text-purple-700">5 ปัญหาเด็กไทย</h3>
                            <p class="text-sm text-slate-500">เลือกปัญหาเพื่อดูผลกระทบ กาย-ใจ</p>
                        </div>

                        <div class="space-y-2">
                            <button onclick="analyzeProblem(1)" class="w-full p-3 text-left rounded-lg border hover:bg-purple-50 hover:border-purple-300 transition-all group">
                                <div class="font-bold text-slate-700 text-sm group-hover:text-purple-700">1. ความเครียดการเรียน</div>
                                <div class="text-xs text-slate-400">Academic Pressure</div>
                            </button>
                            <button onclick="analyzeProblem(2)" class="w-full p-3 text-left rounded-lg border hover:bg-purple-50 hover:border-purple-300 transition-all group">
                                <div class="font-bold text-slate-700 text-sm group-hover:text-purple-700">2. การถูกกลั่นแกล้ง</div>
                                <div class="text-xs text-slate-400">Bullying & Cyberbullying</div>
                            </button>
                            <button onclick="analyzeProblem(3)" class="w-full p-3 text-left rounded-lg border hover:bg-purple-50 hover:border-purple-300 transition-all group">
                                <div class="font-bold text-slate-700 text-sm group-hover:text-purple-700">3. ภาพลักษณ์</div>
                                <div class="text-xs text-slate-400">Body Image & Self-Esteem</div>
                            </button>
                            <button onclick="analyzeProblem(4)" class="w-full p-3 text-left rounded-lg border hover:bg-purple-50 hover:border-purple-300 transition-all group">
                                <div class="font-bold text-slate-700 text-sm group-hover:text-purple-700">4. ติดจอ & หมดไฟ</div>
                                <div class="text-xs text-slate-400">Screen Addiction & Burnout</div>
                            </button>
                            <button onclick="analyzeProblem(5)" class="w-full p-3 text-left rounded-lg border hover:bg-purple-50 hover:border-purple-300 transition-all group">
                                <div class="font-bold text-slate-700 text-sm group-hover:text-purple-700">5. ปัญหาครอบครัว</div>
                                <div class="text-xs text-slate-400">Family Gap</div>
                            </button>
                        </div>
                    </div>

                    <!-- Right: Holistic Analysis -->
                    <div class="lg:w-2/3 space-y-4">
                        <div id="holistic-content" class="h-full flex flex-col space-y-4">
                            <!-- Default State -->
                            <div class="flex-1 bg-white rounded-xl border border-slate-200 p-8 flex flex-col items-center justify-center text-center text-slate-400">
                                <i class="fa-solid fa-puzzle-piece text-5xl mb-4 text-purple-200"></i>
                                <h3 class="text-lg font-bold text-slate-600">Holistic Mental & Physical Correlation</h3>
                                <p class="text-sm mt-2">เลือกปัญหาด้านซ้าย เพื่อดูว่าความเครียดซ่อนรูป<br>ส่งผลกระทบต่อฮอร์โมนและร่างกายเด็กไทยอย่างไร</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FUNCTION 4: Smart Food Order -->
            <div id="view-4" class="hidden p-6 md:p-8 fade-in h-full">
                <div class="flex flex-col h-full">
                    
                    <!-- Header with Sticky Advice -->
                    <div class="mb-6">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="bg-orange-100 p-3 rounded-full text-orange-600">
                                <i class="fa-solid fa-utensils text-xl"></i>
                            </div>
                            <div>
                                <h2 class="text-2xl font-bold text-slate-800">สั่งอาหารตามสั่ง (Smart Food Order)</h2>
                                <p class="text-slate-500 text-sm">หัวใจสำคัญ: "ไม่ชูรส ไม่หวาน และขอเปลี่ยนเป็นน้ำมันน้อยๆ"</p>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-blue-50 p-4 rounded-xl border border-blue-100 flex items-center gap-4">
                                <div class="text-2xl font-bold text-blue-600">2:1:1</div>
                                <div>
                                    <div class="font-bold text-blue-800 text-sm">กฎทองของการกิน</div>
                                    <div class="text-xs text-slate-600">ผัก 2 ส่วน : ข้าว 1 ส่วน : เนื้อ 1 ส่วน (กะด้วยสายตา)</div>
                                </div>
                            </div>
                            <div class="bg-red-50 p-4 rounded-xl border border-red-100 flex items-center gap-4">
                                <div class="text-2xl font-bold text-red-600"><i class="fa-solid fa-ban"></i></div>
                                <div>
                                    <div class="font-bold text-red-800 text-sm">ระวังน้ำซุป! (Sodium Trap)</div>
                                    <div class="text-xs text-slate-600">แหล่งโซเดียมสูง แนะนำให้ "ทานเนื้อ เหลือซุป"</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Menu List Area -->
                    <div class="flex-1 bg-white rounded-xl shadow-sm border border-slate-200 p-4 overflow-y-auto custom-scroll" id="menu-list">
                        <!-- Menu items will be injected here via JS -->
                    </div>

                </div>
            </div>

        </div>
    </div>

    <script>
        // --- 1. Tab Switching ---
        function switchTab(id) {
            document.querySelectorAll('button[id^="tab-"]').forEach(btn => {
                btn.className = "inactive-tab p-3 rounded-xl border shadow-sm font-bold text-sm md:text-base flex flex-col md:flex-row items-center justify-center gap-2 transition-all hover:bg-slate-50";
            });
            document.getElementById(`tab-${id}`).className = "active-tab p-3 rounded-xl border shadow-sm font-bold text-sm md:text-base flex flex-col md:flex-row items-center justify-center gap-2 transition-all shadow-md";

            ['view-1', 'view-2', 'view-3', 'view-4'].forEach(v => document.getElementById(v).classList.add('hidden'));
            document.getElementById(`view-${id}`).classList.remove('hidden');

            if (id === 4) renderSmartMenu();
        }

        // --- 2. Function 1 Logic (Behavior & Rewards) ---
        const behaviors = {
            'sugar': {
                title: "1. ติดหวาน/น้ำชง (Sugar Reduction)",
                mission: "สั่งหวานน้อย ค่อยๆ ถอยความหวาน",
                icon: "fa-glass-water text-pink-500",
                steps: [
                    { week: "สัปดาห์ที่ 1", text: "สั่งระดับความหวานลดลง 1 ระดับ (เช่น ปกติ -> 50%)" },
                    { week: "สัปดาห์ที่ 2", text: "เปลี่ยนจากน้ำชงใส่นม เป็นน้ำใส (ชาใส, อเมริกาโน่)" },
                    { week: "Step พิเศษ", text: "วางน้ำเปล่าข้างๆ: ดูดน้ำหวาน 1 อึก = ดื่มน้ำเปล่า 2 อึก" }
                ],
                color: "pink"
            },
            'sedentary': {
                title: "2. ออฟฟิศซินโดรม (Anti-Sedentary)",
                mission: "กฎ 50/5 ทุบวงจร Office Syndrome",
                icon: "fa-chair text-blue-500",
                steps: [
                    { week: "Alarm", text: "ตั้งนาฬิกาเตือนทุก 50 นาที" },
                    { week: "Action 5 นาที", text: "ลุกยืนทันที! (ห้ามยืดท่านั่ง) เดินไปห้องน้ำ/เติมน้ำ" },
                    { week: "Environment", text: "วางขวดน้ำเล็กบนโต๊ะ บังคับให้ลุกไปเติมบ่อยๆ" }
                ],
                color: "blue"
            },
            'mindful': {
                title: "3. กินเร็ว/กินดึก (Mindful Eating)",
                mission: "หาร 2 วางช้อน",
                icon: "fa-stopwatch text-orange-500",
                steps: [
                    { week: "แบ่งจาน", text: "ใช้สายตาแบ่งอาหารเป็น 2 ส่วนก่อนกิน" },
                    { week: "วางช้อน", text: "กินหมดครึ่งแรก -> วางช้อน ดื่มน้ำ เช็คความอิ่ม" },
                    { week: "เคี้ยว", text: "ตั้งเป้าเคี้ยว 15-20 ครั้งในคำแรกๆ" }
                ],
                color: "orange"
            },
            'neat': {
                title: "4. ขี้เกียจออกกำลัง (Neat Activity)",
                mission: "เดินหลังมื้อเที่ยง 10 นาที",
                icon: "fa-person-walking text-green-500",
                steps: [
                    { week: "Habit Stacking", text: "ผูกพฤติกรรม: กินเสร็จ = เดินทันที" },
                    { week: "Action", text: "เดินแกว่งแขนเบาๆ หรือเดินไปซื้อของไกลขึ้น" },
                    { week: "Benefit", text: "ลดอาการง่วงบ่าย (Food Coma) และลดระดับน้ำตาล" }
                ],
                color: "green"
            },
            'sleep': {
                title: "5. ติดจอ/นอนดึก (Sleep Hygiene)",
                mission: "Digital Sunset (พระอาทิตย์ตกดินดิจิทัล)",
                icon: "fa-moon text-indigo-500",
                steps: [
                    { week: "Bedtime", text: "วางมือถือก่อนนอน 30 นาที (เช่น นอน 5 ทุ่ม วาง 4 ทุ่มครึ่ง)" },
                    { week: "Distance", text: "สายชาร์จต้องอยู่นอกระยะเอื้อมจากเตียง" },
                    { week: "Substitute", text: "อ่านหนังสือเล่มจริง หรือฟังเพลงบรรเลงแทนการไถ Feed" }
                ],
                color: "indigo"
            }
        };

        function runBehavior(type) {
            const data = behaviors[type];
            const content = document.getElementById('f1-content');
            
            const colorClasses = {
                pink: "bg-pink-50 border-pink-200 text-pink-800",
                blue: "bg-blue-50 border-blue-200 text-blue-800",
                orange: "bg-orange-50 border-orange-200 text-orange-800",
                green: "bg-green-50 border-green-200 text-green-800",
                indigo: "bg-indigo-50 border-indigo-200 text-indigo-800"
            };

            const headerColor = colorClasses[data.color];

            let stepsHtml = data.steps.map(s => `
                <li class="flex gap-3 items-start p-3 bg-white rounded-lg shadow-sm">
                    <div class="bg-${data.color}-100 text-${data.color}-600 font-bold px-2 py-1 rounded text-xs whitespace-nowrap">${s.week}</div>
                    <div class="text-sm text-slate-600">${s.text}</div>
                </li>
            `).join('');

            content.innerHTML = `
                <div class="w-full text-left animate-fade-in h-full flex flex-col">
                    <div class="p-4 rounded-xl border-l-8 shadow-sm ${headerColor.replace('text-', 'border-').replace('bg-', 'bg-opacity-50 ')} mb-4">
                        <div class="flex items-center gap-3">
                            <i class="fa-solid ${data.icon.split(' ')[0]} text-2xl"></i>
                            <div>
                                <h2 class="text-lg font-bold ${data.color === 'pink' ? 'text-pink-700' : 'text-' + data.color + '-800'}">${data.title}</h2>
                                <p class="text-sm opacity-80">Mission: "${data.mission}"</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex-1 overflow-y-auto custom-scroll pr-2">
                        <h4 class="font-bold text-slate-700 mb-3 ml-1">แนวทางการทำ (Strategy):</h4>
                        <ul class="space-y-3">
                            ${stepsHtml}
                        </ul>
                    </div>

                    <button class="mt-4 w-full bg-slate-800 text-white py-3 rounded-xl font-bold hover:bg-slate-900 transition flex items-center justify-center gap-2 shadow-lg">
                        <i class="fa-solid fa-check-circle"></i> รับภารกิจนี้ (+50 Points)
                    </button>
                </div>
            `;
            
            content.classList.remove('justify-center', 'items-center', 'text-center');
            content.classList.add('justify-start');
        }


        // --- 4. Function 4 Logic (Smart Food Order) ---
        function renderSmartMenu() {
            const container = document.getElementById('menu-list');
            if(container.children.length > 0) return;

            const menuItems = [
                {name: "คะน้าหมูชิ้น", detail: "ไม่ใส่มันหมู, น้ำมันน้อย, ไม่ชูรส", benefit: "ใยอาหารสูง, โปรตีน", price: "50-60"},
                {name: "ต้มจืดเลือดหมูใบตำลึง", detail: "ไม่เจียว, ไม่หมูกรอบ, ข้าวเปล่า", benefit: "ธาตุเหล็กสูง, พลังงานต่ำ", price: "50-60"},
                {name: "กะเพราอกไก่", detail: "อกไก่ล้วน, น้ำขลุกขลิก, ไข่ต้ม", benefit: "โปรตีนเน้นๆ คุมแคลอรี่", price: "50-70"},
                {name: "สุกี้น้ำไก่/ทะเล", detail: "แยกน้ำจิ้ม, เน้นผัก", benefit: "ใยอาหารสูง ดักจับไขมัน", price: "55-70"},
                {name: "ผัดฉ่าปลา/ไก่", detail: "ไม่ใส่น้ำตาลเพิ่ม", benefit: "สมุนไพรช่วยเผาผลาญ", price: "60-80"},
                {name: "ข้าวกล้องอกไก่นุ่ม", detail: "7-Eleven (แช่เย็น)", benefit: "คาร์บเชิงซ้อน + โปรตีน", price: "45-59"},
                {name: "ไข่ต้ม/ไข่ตุ๋น", detail: "สูตรโซเดียมต่ำ", benefit: "โปรตีนดี (0 Sugar)", price: "10-20"},
                {name: "สลัดผัก/ทูน่า", detail: "น้ำสลัดใส/น้ำยำ", benefit: "วิตามิน ลดคอเลสเตอรอล", price: "30-55"},
                {name: "นมถั่วเหลือง", detail: "สูตรไม่เติมน้ำตาล", benefit: "โปรตีนพืช ไขมันต่ำ", price: "12-15"},
                {name: "อัลมอนด์อบ", detail: "ไม่เติมเกลือ", benefit: "ไขมันดี (HDL) บำรุงหัวใจ", price: "25-35"}
            ];

            let html = `
                <h4 class="font-bold text-slate-700 mb-4 sticky top-0 bg-white pb-2 border-b">10 เมนูแนะนำ & วิธีสั่งเพื่อสุขภาพ</h4>
                <div class="grid grid-cols-1 gap-4">`;

            html += menuItems.map((m, i) => `
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center p-3 rounded-lg border border-slate-100 hover:border-teal-200 hover:bg-teal-50 transition">
                    <div class="flex-1">
                        <div class="font-bold text-slate-700"><span class="text-teal-600 mr-2">${i+1}.</span>${m.name}</div>
                        <div class="text-sm text-slate-500 italic mt-1"><i class="fa-solid fa-comment-dots text-teal-400"></i> สั่ง: "${m.detail}"</div>
                        <div class="inline-block mt-2 text-[10px] text-green-700 bg-green-100 px-2 py-0.5 rounded font-bold">${m.benefit}</div>
                    </div>
                    <div class="text-right mt-2 sm:mt-0">
                        <div class="text-lg font-bold text-slate-600">${m.price}฿</div>
                    </div>
                </div>
            `).join('');
            
            html += `</div>`;
            container.innerHTML = html;
        }

        // --- Other Functions (NCDs & Mind-Body) ---
        
        // NCDs Case Studies
        function showNCDCase(disease) {
            const content = document.getElementById('ncd-content');
            let html = '';
            
            // Reusable Template for Do/Don't
            function createTemplate(title, focus, color, icon, dos, donts) {
                return `
                    <div class="animate-fade-in w-full h-full flex flex-col">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-2xl font-bold text-${color}-800"><i class="fa-solid ${icon}"></i> ${title}</h2>
                            <span class="px-3 py-1 bg-${color}-100 text-${color}-800 rounded-full text-xs font-bold">Focus: ${focus}</span>
                        </div>
                        
                        <div class="flex-1 overflow-y-auto custom-scroll pr-2">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-green-50 p-4 rounded-xl border-l-4 border-green-500 shadow-sm">
                                    <h4 class="font-bold text-green-700 mb-3 text-lg">✅ สิ่งที่ควรทำ (Do)</h4>
                                    <ul class="space-y-3">
                                        ${dos.map(item => `
                                            <li class="flex items-start gap-2 text-sm text-slate-700">
                                                <i class="fa-solid fa-check text-green-500 mt-1"></i>
                                                <span>${item}</span>
                                            </li>`).join('')}
                                    </ul>
                                </div>
                                <div class="bg-red-50 p-4 rounded-xl border-l-4 border-red-500 shadow-sm">
                                    <h4 class="font-bold text-red-700 mb-3 text-lg">❌ สิ่งที่ไม่ควรทำ (Don't)</h4>
                                    <ul class="space-y-3">
                                        ${donts.map(item => `
                                            <li class="flex items-start gap-2 text-sm text-slate-700">
                                                <i class="fa-solid fa-xmark text-red-500 mt-1"></i>
                                                <span>${item}</span>
                                            </li>`).join('')}
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="mt-4 text-center text-xs text-slate-400 border-t pt-2">
                            <i class="fa-solid fa-quote-left"></i> ทุกโรคมีจุดร่วมเดียวกันคือ "น้ำตาล" และ "ความเครียด" <i class="fa-solid fa-quote-right"></i>
                        </div>
                    </div>`;
            }

            if (disease === 'diabetes') {
                html = `
                    <div class="animate-fade-in w-full">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-2xl font-bold text-blue-800"><i class="fa-solid fa-droplet"></i> โรคเบาหวาน (Type 2)</h2>
                            <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-bold">Focus: Glucose</span>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-xl border border-blue-100 mb-4">
                            <h4 class="font-bold text-blue-700 mb-2">Analysis & Alert</h4>
                            <p class="text-sm text-slate-700">"คุณเอครับ พบว่า 3 วันนี้ระดับน้ำตาลหลังมื้อเที่ยงสูงกว่า 180 mg/dL ติดต่อกัน แนะนำลดข้าวแป้งมื้อถัดไป หรือเดิน 15 นาทีครับ"</p>
                        </div>
                        <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
                            <h4 class="font-bold text-slate-700 mb-2">Medical Companion</h4>
                            <div class="flex justify-between text-sm border-b pb-2 mb-2"><span>ยา Metformin 500mg</span> <span class="text-green-600"><i class="fa-solid fa-check"></i> ทานแล้ว</span></div>
                            <div class="text-xs text-slate-500">Est. HbA1c: 6.8% (Good Control)</div>
                        </div>
                        <div class="mt-4 text-center text-xs text-slate-400 border-t pt-2">
                            <i class="fa-solid fa-quote-left"></i> ทุกโรคมีจุดร่วมเดียวกันคือ "น้ำตาล" และ "ความเครียด" <i class="fa-solid fa-quote-right"></i>
                        </div>
                    </div>`;
            } else if (disease === 'hypertension') {
                html = `
                    <div class="animate-fade-in w-full">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-2xl font-bold text-red-800"><i class="fa-solid fa-heart-pulse"></i> โรคความดันโลหิตสูง</h2>
                            <span class="px-3 py-1 bg-red-100 text-red-800 rounded-full text-xs font-bold">Focus: Sodium</span>
                        </div>
                        <div class="bg-red-50 p-4 rounded-xl border border-red-100 mb-4">
                            <h4 class="font-bold text-red-700 mb-2">Proactive Intervention</h4>
                            <p class="text-sm text-slate-700 mb-2"><strong>Sodium Alert:</strong> "มื้อเที่ยงทานก๋วยเตี๋ยว (ซุปเยอะ) เย็นนี้แนะนำเมนู Low Sodium"</p>
                            <p class="text-sm text-slate-700"><strong>Sleep Impact:</strong> "นอนน้อย < 5 ชม. ความดันอาจสูงขึ้น 10-15 mmHg"</p>
                        </div>
                        <div class="mt-4 text-center text-xs text-slate-400 border-t pt-2">
                            <i class="fa-solid fa-quote-left"></i> ทุกโรคมีจุดร่วมเดียวกันคือ "น้ำตาล" และ "ความเครียด" <i class="fa-solid fa-quote-right"></i>
                        </div>
                    </div>`;
            } else if (disease === 'dyslipidemia') {
                html = createTemplate(
                    "ไขมันในเลือดสูง (Dyslipidemia)", 
                    "Oil & Sugar", 
                    "yellow", 
                    "fa-bacon",
                    [
                        "<strong>กินไขมันดี:</strong> ปลาทะเล, อะโวคาโด, ถั่วเปลือกแข็ง, น้ำมันรำข้าว/มะกอก",
                        "<strong>เพิ่มใยอาหาร:</strong> ผักใบเขียวและธัญพืช ช่วยดักจับไขมัน",
                        "<strong>ปรุงสุก:</strong> ใช้วิธี ต้ม นึ่ง อบ แทนการทอด"
                    ],
                    [
                        "<strong>เลี่ยงไขมันทรานส์:</strong> เบเกอรี่, ครีมเทียม, มาการีน (ทำลายหลอดเลือดที่สุด)",
                        "<strong>ลดของมัน/กะทิ:</strong> หมูสามชั้น, หนังไก่, แกงกะทิข้นๆ",
                        "<strong>อย่ากินหวานจัด:</strong> น้ำตาลส่วนเกินจะเปลี่ยนเป็นไขมันไตรกลีเซอไรด์"
                    ]
                );
            } else if (disease === 'copd') {
                html = createTemplate(
                    "ปอดอุดกั้นเรื้อรัง (COPD)", 
                    "Breathing & Energy", 
                    "gray", 
                    "fa-lungs",
                    [
                        "<strong>มื้อเล็กแต่บ่อย:</strong> แบ่ง 5-6 มื้อ ไม่ให้ท้องอืดดันกระบังลม",
                        "<strong>เน้นโปรตีน:</strong> ไข่ขาว, ปลา, เนื้อไม่ติดมัน เพื่อรักษาแรงหายใจ",
                        "<strong>ดื่มน้ำสะอาด:</strong> ช่วยให้เสมหะไม่เหนียวข้น ขับออกง่าย"
                    ],
                    [
                        "<strong>งดสูบบุหรี่เด็ดขาด:</strong> เลี่ยงควันมือสองและฝุ่น PM 2.5",
                        "<strong>เลี่ยงอาหารทำให้อืด:</strong> น้ำอัดลม, ถั่วบางชนิด, กะหล่ำดิบ (ทำให้หอบ)",
                        "<strong>อย่าอยู่ในที่อับ:</strong> เลี่ยงที่อากาศไม่ถ่ายเทหรือมีกลิ่นฉุน"
                    ]
                );
            } else if (disease === 'cancer') {
                html = createTemplate(
                    "โรคมะเร็ง (Cancer)", 
                    "Hygiene & Nutrition", 
                    "purple", 
                    "fa-ribbon",
                    [
                        "<strong>กินปรุงสุกใหม่:</strong> ป้องกันการติดเชื้อ (เพราะภูมิต้านทานต่ำ)",
                        "<strong>เน้นโปรตีนคุณภาพ:</strong> ปลา, ไข่, นมถั่วเหลือง เพื่อซ่อมแซมเซลล์",
                        "<strong>ผักผลไม้หลากสี:</strong> ล้างสะอาดที่สุด รับสารต้านอนุมูลอิสระ"
                    ],
                    [
                        "<strong>งดของหมักดอง/รมควัน:</strong> อาหารแปรรูป, ปลาร้า, แหนม, ของไหม้เกรียม",
                        "<strong>อย่ากินของดิบ:</strong> ปลาดิบ, ไข่ดอง, ผักสดที่ไม่สะอาด",
                        "<strong>เลี่ยงรสจัดเกินไป:</strong> ลดการระคายเคืองในช่องปากและลำไส้"
                    ]
                );
            } else if (disease === 'metabolic') {
                html = createTemplate(
                    "โรคอ้วนลงพุง (Metabolic Syn.)", 
                    "Energy Management", 
                    "orange", 
                    "fa-weight-scale",
                    [
                        "<strong>สูตร 2:1:1:</strong> ผัก 2 : ข้าว 1 : เนื้อ 1 ในทุกมื้อ",
                        "<strong>ขยับร่างกาย:</strong> เดินเร็ว/แกว่งแขน อย่างน้อยวันละ 30 นาที",
                        "<strong>ดื่มน้ำเปล่าเป็นหลัก:</strong> ดื่ม 1 แก้วก่อนกินข้าว ช่วยให้อิ่มเร็ว"
                    ],
                    [
                        "<strong>งดมื้อดึก:</strong> ไม่กินก่อนนอนอย่างน้อย 3 ชั่วโมง",
                        "<strong>เลี่ยงน้ำหวาน:</strong> แคลอรี่จากน้ำตาลเหลวคือตัวการพุงยื่น",
                        "<strong>อย่ากินไปดูจอไป:</strong> จะทำให้กินเพลินเกินปริมาณโดยไม่รู้ตัว"
                    ]
                );
            }

            content.innerHTML = html;
            // Clean up centering classes if content is long
            content.classList.remove('justify-center', 'items-center');
            content.classList.add('justify-start');
        }

        // 5 Youth Problems (Same)
        const youthProblems = {
            1: { title: "1. ความเครียดการเรียน (Academic)", nlp: "อ่านหนังสือไม่ทัน... พ่อต้องผิดหวัง", impact: "Adrenaline & Cortisol สูง, หัวใจเต้นเร็ว, โรคกระเพาะ", advice: "เทคนิค Pomodoro (อ่าน 25 พัก 5), แจ้งเตือนเมื่อนอนดึก", color: "purple" },
            2: { title: "2. การถูกกลั่นแกล้ง (Bullying)", nlp: "ไม่อยากไปโรงเรียน... อายเพื่อน", impact: "เครียดเรื้อรัง, ภูมิต้านทานตก, Eating Disorder", advice: "Butterfly Hug (กอดตัวเอง), Digital Detox", color: "pink" },
            3: { title: "3. ภาพลักษณ์ (Body Image)", nlp: "ทำไมขาใหญ่... เกลียดหุ่นตัวเอง", impact: "น้ำตาลตก, สลายกล้ามเนื้อ (Metabolic Damage)", advice: "กินครบ 5 หมู่แต่ไม่อ้วน, Muscle vs Fat Education", color: "rose" },
            4: { title: "4. ติดจอ & หมดไฟ (Screen Addiction)", nlp: "เบื่อโลก... ขอเล่นเกมต่อ", impact: "Blue Light ยับยั้ง Melatonin, นาฬิกาชีวิตพัง", advice: "Active Break: ลุกเต้น 1 เพลง แลกเล่นเกม 15 นาที", color: "indigo" },
            5: { title: "5. ปัญหาครอบครัว (Family Gap)", nlp: "พ่อแม่ไม่เคยฟัง... อึดอัด", impact: "หลอดเลือดหดเกร็ง, ไมเกรน, IBS", advice: "I-Message (พูดความรู้สึก), Podcast จิตวิทยา", color: "orange" }
        };

        function analyzeProblem(id) {
            const data = youthProblems[id];
            const content = document.getElementById('holistic-content');
            const colorClasses = { purple: "bg-purple-50 text-purple-800", pink: "bg-pink-50 text-pink-800", rose: "bg-rose-50 text-rose-800", indigo: "bg-indigo-50 text-indigo-800", orange: "bg-orange-50 text-orange-800" };
            
            content.innerHTML = `
                <div class="animate-fade-in space-y-4 text-left w-full">
                    <div class="p-4 rounded-xl border-l-8 shadow-sm ${colorClasses[data.color]} border-${data.color}-200">
                        <h2 class="text-xl font-bold">${data.title}</h2>
                    </div>
                    <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
                        <h4 class="font-bold text-slate-700 mb-2"><i class="fa-solid fa-comment-dots text-blue-500"></i> NLP Analysis</h4>
                        <div class="italic text-slate-600 text-sm mb-1">"${data.nlp}"</div>
                    </div>
                    <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
                        <h4 class="font-bold text-slate-700 mb-2"><i class="fa-solid fa-link text-red-500"></i> Impact Correlation</h4>
                        <div class="text-sm text-slate-600">${data.impact}</div>
                    </div>
                    <div class="bg-green-50 p-4 rounded-xl border border-green-200 shadow-sm">
                        <h4 class="font-bold text-green-800 mb-2"><i class="fa-solid fa-robot"></i> AI Advice</h4>
                        <div class="text-sm text-green-900">${data.advice}</div>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>